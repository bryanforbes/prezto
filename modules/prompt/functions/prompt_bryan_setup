pmodload 'helper'

function prompt_bryan_precmd {
	if (( $+functions[git-info] )); then
		git-info
	fi
	if (( $+functions[python-info] )); then
		python-info
	fi
	if (( $+functions[node-info] )); then
		node-info
	fi
}

function prompt_bryan_setup {
	setopt LOCAL_OPTIONS
	unsetopt XTRACE KSH_ARRAYS
	prompt_opts=(cr percent subst)

	# Load required functions
	autoload -Uz add-zsh-hook

	# Add hook for calling vcs_info before each command
	add-zsh-hook precmd prompt_bryan_precmd

	# Set git-info parameters
	zstyle ':prezto:module:git:info' verbose 'yes'
	zstyle ':prezto:module:git:info:branch' format '%b'
	zstyle ':prezto:module:git:info:dirty' format '!'
	zstyle ':prezto:module:git:info:keys' format \
		'prompt' ' (git) [$(coalesce "%b" "%p" "%c")%D] ' \
		'rprompt' ''

	# Set node-info parameters
	zstyle ':prezto:module:node:info:version' format 'Node [%v]'

	PROMPT='%B%F{green}%n%f%b at %B%F{yellow}%m%f%b in %B%F{blue}%~%f%b
${git_info:+${(e)git_info[prompt]}}%# '
	# RPROMPT='$node_info[version]'
}

prompt_bryan_setup "$@"
